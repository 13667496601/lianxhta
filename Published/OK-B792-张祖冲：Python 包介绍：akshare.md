《akshare - 面向 Python 量化分析师的综合指南》


## 1. 引言 - akshare 的设计哲学与生态系统

### 1.1. 什么是 akshare？优雅的抽象层

`akshare` 是一个为金融数据分析而生的开源 Python 库，其核心设计哲学可以用其自我描述来概括：“为人类设计的优雅简洁的 Python 金融数据接口库”，这一定位明确了其以用户为中心、追求易用性的目标。

对该库的深入考察揭示了其运作模式的本质：`akshare` 并非一个原始数据提供商，而是一个功能强大的数据聚合与抽象层。这一点可以从其接口函数的命名约定中得到证实，例如 `stock_zh_a_spot_em` 和 `futures_zh_daily_sina`。函数名中的后缀

`_em` 和 `_sina` 分别指向其底层数据源——东方财富网和新浪财经。`akshare` 的核心价值在于，它将用户从繁琐复杂的网络数据抓取（Web Scraping）和不同网站 API 的解析工作中解放出来。它通过提供一个统一、稳定的 API，将来自不同来源、结构各异的数据，标准化为 pandas DataFrame 格式，极大地简化了数据获取流程。这种设计既让用户能够免费访问海量的公开金融数据，又无需关心底层数据源的变化和实现细节。

### 1.2. 社区信任与项目活力

一个开源项目的可靠性与生命力，很大程度上取决于其社区的活跃度和认可度。`akshare` 在这方面表现出色，其 GitHub 仓库的数据提供了强有力的证明：

- **社区认可度**：超过 12,200 个星标（Stars）和 1,300 个项目的依赖使用，表明它在开发者社区中获得了高度关注和广泛的实际应用。
- **协作与贡献**：拥有超过 2,300 个分支（Forks）和 91 位贡献者，这反映了一个健康、活跃的协作开发环境。
- **专业背书**：知名开发者工具提供商 JetBrains 作为其赞助商之一，为项目增添了重要的专业信誉。
- **持续维护**：项目已发布 31 个版本，并保持着积极的更新节奏。例如，其更新日志中记录了对 `rate_interbank` 等接口的修复，这表明维护团队对社区反馈和 bug 修复的响应非常及时。
### 1.3. 安装入门与重要须知

开始使用 `akshare` 的过程非常简单，仅需通过 Python 的包管理器 pip 执行标准安装命令：

```Python
pip install akshare
```

然而，在深入使用之前，用户必须理解并遵守其数据使用声明。`akshare` 明确指出，其提供的数据“仅用于学术研究目的”，不构成任何投资建议，并且由于数据源等“不可控因素”，部分数据接口可能会在未来被移除。这一定位对于设定专业界限和管理用户对抓取数据的期望至关重要。

此外，使用者可能会注意到一个现象：项目的 GitHub 仓库响应迅速、维护良好，而其官方文档网站（akshare.akfamily.xyz）有时可能出现访问不稳定的情况。这在开源项目中并不罕见，通常意味着核心开发资源集中在代码本身和 GitHub 社区上。因此，建议用户将**GitHub 仓库**作为获取最新信息、追踪问题和寻求支持的首要渠道，这能有效避免因网站问题带来的困扰，并直接接入最活跃的社区支持中心。

---

## 2. 核心数据获取 - 中国 A 股市场

`akshare` 在中国 A 股市场的数据获取方面功能尤为强大，覆盖了从实时行情到深度历史数据的多种需求，并提供了量化分析所必需的关键功能。

### 2.1. 实时市场快照

对于需要全面了解市场实时动态的分析师而言，`akshare` 提供了一个极其便利的接口。通过调用 `ak.stock_zh_a_spot_em()` 函数，可以一键获取沪深京 A 股所有上市公司的实时行情数据。

**代码示例：获取 A 股实时行情**

```Python
import akshare as ak

# 获取沪深京 A 股实时行情数据
stock_zh_a_spot_em_df = ak.stock_zh_a_spot_em()

# 显示数据框的前几行
print(stock_zh_a_spot_em_df.head())
```

```
   序号      代码      名称    最新价    涨跌幅   涨跌额       成交量           成交额     振幅     最高     最低     今开     昨收    量比    换手率  市盈率-动态   市净率           总市值          流通 市值   涨速  5分钟涨跌  60日涨跌幅  年初至今涨跌幅
0   1  300993    玉马科技  14.68  20.03  2.45  327918.0  4.336300e+08  21.10  14.68  12.10  12.20  12.23  2.87  13.59   37.46  3.13  4.523366e+09  3.541780e+09  0.0    0.0   36.05    31.19
1   2  300650    太龙股份  17.03  20.01  2.84  385574.0  6.193797e+08  19.24  17.03  14.30  14.49  14.19  4.94  25.24  144.60  2.98  3.717583e+09  2.601650e+09  0.0    0.0   25.87    48.47
2   3  300991     创益通  28.97  20.01  4.83  175393.0  4.763418e+08  21.58  28.97  23.76  24.26  24.14  4.78  19.51  166.35  6.49  4.171680e+09  2.604171e+09  0.0    0.0   53.28    40.22
3   4  301024    霍普股份  47.88  20.00  7.98   54306.0  2.491418e+08  22.51  47.88  38.90  39.00  39.90  0.94   9.02  -86.24  7.21  3.044450e+09  2.882855e+09  0.0    0.0   86.30   101.18
4   5  688062  迈威生物-U  28.62  20.00  4.77  296333.0  8.274653e+08   9.73  28.62  26.30  26.50  23.85  2.30  14.51   -9.80  8.95  1.143655e+10  5.843345e+09  0.0    0.0   40.23    41.68

```

此函数返回的 DataFrame 不仅包含基础的价格信息，还集成了大量经过计算的、具有极高分析价值的指标，如动态市盈率、市净率、总市值、流通市值和换手率等。这使得分析师可以在一个 API 调用中获取构建复杂筛选策略所需的大部分数据，极大地提升了研究效率。

**表 2.1: `stock_zh_a_spot_em()` 关键输出字段**

|字段名称|类型|描述|
|---|---|---|
|`代码`|object|股票代码|
|`名称`|object|股票名称|
|`最新价`|float64|当前最新成交价|
|`涨跌幅`|float64|涨跌幅，单位：%|
|`成交量`|float64|成交量，单位：手|
|`成交额`|float64|成交额，单位：元|
|`换手率`|float64|换手率，单位：%|
|`市盈率-动态`|float64|动态市盈率|
|`市净率`|float64|市净率|
|`总市值`|float64|总市值，单位：元|
|`流通市值`|float64|流通市值，单位：元|

### 2.2. 历史价格数据：复权的决定性作用

历史 K 线数据是所有回测和时间序列分析的基石。`akshare` 通过 `stock_zh_a_hist()` 接口提供了强大的历史数据获取功能。然而，该接口最能体现其专业性的地方在于对**数据复权(Adjustment)的深入支持。

在金融市场中，股票因分红、送股、配股等事件会导致股价出现断层，若直接使用未复权的价格序列进行分析，会严重扭曲收益率计算和技术指标的有效性。`akshare` 的设计者显然深刻理解这一量化分析的核心痛点，因此在接口中内置了 `adjust` 参数。该参数支持不复权、前复权（`qfq`）和后复权（`hfq`）三种模式。
- **前复权 (`qfq`)**：保持当前价格不变，向前调整历史价格。优点是便于看盘，与行情软件默认显示一致。缺点是历史价格会随每次除权而改变，甚至可能出现负值。
- **后复权 (`hfq`)**：保持上市首日价格不变，向后调整价格。优点是能真实反映投资者的累计财富增长，是计算真实历史回报率的唯一可靠方法。因此，在严谨的量化投资研究中，后复权数据是首选标准。
`akshare` 对复权概念的清晰阐释和功能支持，表明它不仅仅是一个数据抓取工具，更是一个由实践者为实践者打造的、深刻理解金融分析需求的专业库。

**代码示例：获取某只股票的后复权日 K 线数据**

```Python
import akshare as ak

# 获取平安银行（000001）从 2017-03-01 到 2024-05-28 的后复权（hfq）日 K 线数据
stock_zh_a_hist_hfq_df = ak.stock_zh_a_hist(symbol="000001", 
                                           period="daily", 
                                           start_date="20170301", 
                                           end_date='20240528', 
                                           adjust="hfq")

# 显示后复权数据
print(stock_zh_a_hist_hfq_df.tail())
```

```
              日期    股票代码       开盘       收盘       最高       最低      成交量           成交额    振幅   涨跌幅    涨跌额   换手率
1755  2024-05-22  000001  1639.33  1639.33  1661.84  1626.83  2115531  2.458449e+09  2.14  0.08   1.25  1.09
1756  2024-05-23  000001  1635.58  1619.33  1643.08  1615.58  1841623  2.110799e+09  1.68 -1.22 -20.00  0.95
1757  2024-05-24  000001  1615.58  1608.08  1630.58  1606.83  1398276  1.593330e+09  1.47 -0.69 -11.25  0.72
1758  2024-05-27  000001  1608.08  1633.08  1635.58  1608.08  1454361  1.663272e+09  1.71  1.55  25.00  0.75
1759  2024-05-28  000001  1631.83  1619.33  1641.83  1614.33  1204323  1.377107e+09  1.68 -0.84 -13.75  0.62
```

**表 2.2: `stock_zh_a_hist` 输入参数**

|参数|类型|描述|示例|
|---|---|---|---|
|`symbol`|str|股票代码|`'000001'`|
|`period`|str|数据周期|`'daily'`, `'weekly'`, `'monthly'`|
|`start_date`|str|开始日期|`'20170301'`|
|`end_date`|str|结束日期|`'20240528'`|
|`adjust`|str|复权方式|`""` (不复权), `"qfq"`, `"hfq"`|

**表 2.3: `stock_zh_a_hist` 输出字段**

|字段名称|类型|描述|
|---|---|---|
|`日期`|object|交易日期|
|`开盘`|float64|开盘价|
|`收盘`|float64|收盘价|
|`最高`|float64|最高价|
|`最低`|float64|最低价|
|`成交量`|int64|成交量，单位：手|
|`成交额`|float64|成交额，单位：元|
|`换手率`|float64|换手率，单位：%|

---

## 3. 拓宽视野 - 期货、宏观经济与利率

`akshare` 的价值远不止于股票市场，它还提供了对其他重要资产类别和经济指标的广泛覆盖，使其成为一个全面的宏观和跨市场分析工具。

### 3.1. 衍生品市场：商品期货

对于衍生品分析师，`akshare` 同样提供了便捷的数据接口。以大宗商品期货为例，可以使用 `futures_zh_daily_sina` 获取中国期货市场的历史日度数据。

一个关键细节在于其对“主力连续合约”的支持。在期货分析中，研究者通常需要一个连续的历史价格序列，而非单个到期合约。`akshare` 通过特定的合约代码约定（如 `M0` 代表豆粕主力连续合约）解决了这个问题，极大地简化了数据拼接工作。

**代码示例：获取豆粕主力连续合约历史数据**

```Python
import akshare as ak

# 获取大连商品交易所豆粕主力连续合约（M0）的历史日线数据
futures_soybean_meal_df = ak.futures_zh_daily_sina(symbol="M0")

# 显示数据
print(futures_soybean_meal_df.tail())
```

```
            date    open    high     low   close   volume     hold  settle
4980  2025-06-23  3074.0  3076.0  3021.0  3037.0  1158175  2341727  3042.0
4981  2025-06-24  3033.0  3040.0  3013.0  3037.0   904147  2330396  3029.0
4982  2025-06-25  3031.0  3037.0  2988.0  2993.0  1342168  2270410  3009.0
4983  2025-06-26  2986.0  2988.0  2921.0  2936.0  1851366  2252700  2951.0
4984  2025-06-27  2940.0  2949.0  2926.0  2946.0   987064  2221758  2938.0
```

返回的数据中，除了标准的开高低收（OHLC）和成交量（volume），还包含了 `hold`（持仓量）和 `settle`（结算价）字段。持仓量是衡量市场参与度和资金流入流出的关键指标，对于期货分析至关重要。`akshare` 将这些领域特定的关键数据点包含在内，再次证明了其设计的专业性。

**表 3.1: `futures_zh_daily_sina` 输出字段**

|字段名称|类型|描述|
|---|---|---|
|`date`|object|交易日期|
|`open`|float64|开盘价|
|`high`|float64|最高价|
|`low`|float64|最低价|
|`close`|float64|收盘价|
|`volume`|int64|成交量|
|`hold`|int64|持仓量|
|`settle`|float64|结算价|

### 3.2. 宏观经济指标

宏观经济数据是理解市场大环境、进行自上而下分析的基础。`akshare` 提供了一系列接口来获取关键的宏观经济指标。

#### 3.2.1. 国民经济健康度 (GDP)

通过 `macro_china_gdp` 接口，可以获取中国的季度国内生产总值数据。该函数返回包含 GDP 绝对值、同比增长率，以及按第一、二、三产业划分的详细数据的 DataFrame，为宏观经济研究提供了高质量的数据基础。

**代码示例：获取中国季度 GDP 数据**

```Python
import akshare as ak

# 获取中国季度 GDP 数据
macro_china_gdp_df = ak.macro_china_gdp()
print(macro_china_gdp_df.head())
```

```
            季度  国内生产总值-绝对值  国内生产总值-同比增长  第一产业-绝对值  第一产业-同比增长  第二产业-绝对值  第二产业-同比增长  第三产业-绝对值  第三产业-同比增长
0    2025年第1季度    318758.0          5.4   11712.8        3.5  111902.9        5.9  195142.3        5.3
1  2024年第1-4季度   1349083.5          5.0   91413.9        3.5  492087.1        5.3  765582.5        5.0
2  2024年第1-3季度    975357.4          4.8   57363.6        3.4  356492.0        5.4  561501.8        4.7
3  2024年第1-2季度    633599.4          5.0   30468.8        3.5  233253.0        5.8  369877.5        4.6
4    2024年第1季度    304761.8          5.3   11458.8        3.3  108277.4        6.0  185025.6        5.0
```

#### 3.2.2. 货币市场动态 (Shibor)

利率是金融市场的核心定价基准。`akshare` 通过 `rate_interbank` 接口提供了获取银行间同业拆借利率的功能，例如上海银行间同业拆放利率（Shibor）6。该接口的设计体现了良好的扩展性，用户可以通过

`market`、`symbol` 和 `indicator` 三个参数，灵活地获取不同市场、不同品种、不同期限的利率数据。

**代码示例：获取 3 个月 Shibor 利率**

```Python
import akshare as ak

# 获取上海银行间同业拆借市场、Shibor人民币、3个月期限的利率数据
shibor_3m_df = ak.rate_interbank(market="上海银行同业拆借市场", 
                                 symbol="Shibor人民币", 
                                 indicator="3月")
print(shibor_3m_df.tail())
```

```
             报告日     利率   涨跌
4672  2025-06-23  1.629  0.0
4673  2025-06-24  1.629  0.0
4674  2025-06-25  1.630  0.1
4675  2025-06-26  1.630  0.0
4676  2025-06-27  1.630  0.0
```

**表 3.2: `rate_interbank` 关键输入参数**

|参数|类型|描述|示例|
|---|---|---|---|
|`market`|str|市场名称|`"上海银行同业拆借市场"`|
|`symbol`|str|品种名称|`"Shibor人民币"`|
|`indicator`|str|指标/期限|`"隔夜"`, `"1周"`, `"3月"`, `"1年"`|

---

## 4. 从数据到洞察 - 一个实用的分析工作流

获取数据仅仅是第一步。`akshare` 的真正威力在于它能与 Python 强大的数据科学生态无缝集成，将原始数据转化为有价值的分析洞察。本节将演示一个完整的分析流程：从获取数据，到计算技术指标，再到最终的可视化呈现。

### 4.1. 数据整理与技术指标计算

此工作流将使用在第 2.2 节中获取的后复权历史股价数据。首先，进行必要的数据整理，即将日期列设为索引，这对于进行时间序列分析至关重要。然后，计算两条常用的技术指标：20 日简单移动平均线（SMA20）和 50 日简单移动平均线（SMA50）。

**代码示例：计算移动平均线**

```Python
import pandas as pd
import akshare as ak

# 获取平安银行（000001）从 2017-03-01 到 2024-05-28 的后复权（hfq）日 K 线数据
stock_zh_a_hist_hfq_df = ak.stock_zh_a_hist(symbol="000001",
                                           period="daily",
                                           start_date="20170301",
                                           end_date='20240528',
                                           adjust="hfq")
# 1. 将日期列转换为 datetime 对象并设为索引
stock_zh_a_hist_hfq_df['日期'] = pd.to_datetime(stock_zh_a_hist_hfq_df['日期'])
stock_zh_a_hist_hfq_df.set_index('日期', inplace=True)

# 2. 计算 20 日和 50 日简单移动平均线
stock_zh_a_hist_hfq_df['SMA_20'] = stock_zh_a_hist_hfq_df['收盘'].rolling(window=20).mean()
stock_zh_a_hist_hfq_df['SMA_50'] = stock_zh_a_hist_hfq_df['收盘'].rolling(window=50).mean()
# 显示包含 SMA 的数据
print(stock_zh_a_hist_hfq_df.tail())
```

```
              股票代码       开盘       收盘       最高       最低      成交量           成交额    振幅   涨跌幅    涨跌额   换手率     SMA_20     SMA_50
日期
2024-05-22  000001  1639.33  1639.33  1661.84  1626.83  2115531  2.458449e+09  2.14  0.08   1.25  1.09  1559.1320  1523.8886
2024-05-23  000001  1635.58  1619.33  1643.08  1615.58  1841623  2.110799e+09  1.68 -1.22 -20.00  0.95  1564.7580  1526.4390
2024-05-24  000001  1615.58  1608.08  1630.58  1606.83  1398276  1.593330e+09  1.47 -0.69 -11.25  0.72  1569.5715  1528.7644
2024-05-27  000001  1608.08  1633.08  1635.58  1608.08  1454361  1.663272e+09  1.71  1.55  25.00  0.75  1575.6975  1531.3648
2024-05-28  000001  1631.83  1619.33  1641.83  1614.33  1204323  1.377107e+09  1.68 -0.84 -13.75  0.62  1580.6360  1533.4652
(base)PS D:\Workspace\ZZChong> 
```

### 4.2. 可视化价格趋势与交易信号

数据可视化是理解复杂趋势和模式的最直观方式。利用 `matplotlib` 库，可以将股价和计算出的移动平均线绘制在同一张图上，从而清晰地观察价格走势和潜在的交易信号。

**代码示例：绘制股价与移动平均线**

```Python
import matplotlib.pyplot as plt
import matplotlib.dates as mdates

# 设置中文字体，以防乱码
plt.rcParams['font.sans-serif'] =
plt.rcParams['axes.unicode_minus'] = False

# 创建图表
fig, ax = plt.subplots(figsize=(14, 7))

# 绘制后复权收盘价、SMA20 和 SMA50
ax.plot(stock_zh_a_hist_hfq_df.index, stock_zh_a_hist_hfq_df['收盘'], label='后复权收盘价', color='blue', alpha=0.7)
ax.plot(stock_zh_a_hist_hfq_df.index, stock_zh_a_hist_hfq_df, label='20日移动平均线', color='orange', linestyle='--')
ax.plot(stock_zh_a_hist_hfq_df.index, stock_zh_a_hist_hfq_df, label='50日移动平均线', color='red', linestyle='--')

# 设置图表标题和标签
ax.set_title('平安银行 (000001) - 股价与移动平均线', fontsize=16)
ax.set_xlabel('日期', fontsize=12)
ax.set_ylabel('后复权价格 (元)', fontsize=12)
ax.legend()
ax.grid(True)

# 格式化日期显示
ax.xaxis.set_major_formatter(mdates.DateFormatter('%Y-%m'))
fig.autofmt_xdate()

# 显示图表
plt.show()
```

这张图表不仅展示了股价的长期趋势，更重要的是揭示了短期趋势（SMA20）和中期趋势（SMA50）之间的关系。在技术分析中，短期均线上穿长期均线（例如 SMA20 上穿 SMA50）通常被视为一个看涨信号（“金叉”），而下穿则被视为看跌信号（“死叉”）。通过这种可视化分析，分析师可以快速识别潜在的市场转折点。

---

## 5. 结论 - akshare 在现代量化工具箱中的地位

经过全面的评估，`akshare` 无疑是现代 Python 量化分析师和数据科学家工具箱中一个极具价值的组成部分。

### 5.1. 核心优势总结

`akshare` 的主要优势可以归结为以下几点：
- **全面的数据覆盖**：提供了一个统一接口，可访问包括股票、期货、宏观经济和利率在内的多种金融数据，满足了跨市场和多资产分析的需求。
- **面向实践者的设计**：内置了如股价后复权（`hfq`）和期货持仓量（`hold`）等对于严谨量化分析至关重要的领域特定功能，体现了其设计的专业性和深度。
- **简洁与强大**：API 设计简单易用，通过返回标准的 pandas DataFrame，能够与 Python 数据科学生态（如 `pandas`, `matplotlib`）无缝集成，兼具易用性与强大的扩展能力。
- **活跃且响应迅速的社区**：强大的 GitHub 指标、专业机构的赞助以及持续的版本迭代和问题修复，共同构建了一个可靠、有生命力的开源生态系统。

### 5.2. 最终评估与建议

`akshare` 是一个用于快速策略原型设计、学术研究、以及个人量化分析的卓越工具。它极大地降低了金融数据获取的门槛，使研究者能够将精力更专注于策略开发和数据分析本身。

对于使用者而言，最佳实践是充分利用其带来的巨大便利，同时对其运作模式有清晰的认知：它是一个高效的网页数据聚合层，而非一个有服务等级协议（SLA）保障的商业数据源。因此，在遇到问题或需要获取最新信息时，应优先求助于其活跃的 **GitHub 社区**。

综上所述，`akshare` 凭借其广泛的覆盖范围、专业的功能设计和活跃的社区支持，已经成为中国金融市场数据分析领域一个不可或缺的开源库。

**推荐资源：**
- **项目源码与社区支持**: [https://github.com/akfamily/akshare](https://github.com/akfamily/akshare) 1
- **官方文档**: [https://akshare.akfamily.xyz/](https://akshare.akfamily.xyz/)
